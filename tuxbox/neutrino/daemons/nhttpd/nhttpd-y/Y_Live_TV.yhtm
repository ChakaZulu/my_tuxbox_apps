<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<link rel="stylesheet" type="text/css" href="/Y_Main.css">
<script language="JavaScript" type="text/javascript">
function do_stop()
{
        document.vlc.stop()
}
function doPlayOrPause()
{
    if( document.vlc.{=if-equal:{=browser=}~ie~playing~isplaying()=} )
    {
    	document.v.PlayOrPause.value = " Play ";
        document.vlc.pause()
    } else {
	    document.v.PlayOrPause.value = "Pause";
        document.vlc.play()
    }
}
function doStop()
{
    	document.v.PlayOrPause.value = " Play ";
        document.vlc.stop()
}
function doLockUnlock()
{
    if( document.v.lock.value == "Lock" )
    {
    	document.v.lock.value = "Unlock";
        parent.dbox.location.href='/control/exec?Y_Live&live_lock'
    } else {
	    document.v.lock.value = "Lock";
        parent.dbox.location.href='/control/exec?Y_Live&live_unlock'
    }
}
function view_streaminfo()
{
	window.open("/fb/info.dbox2","streaminfo","width=400,height=400");
}

</script>
</head>
{=script:Y_Live prepare_tv=}

<body style="background-color: #f0faff">
<table class="y_live_table" cellspacing="0" bgcolor="#F0FAFF">
<tr><td>
{=if-equal:{=browser=}~ie~
	<OBJECT classid="clsid:E23FE9C6-778E-49D4-B537-38FCDE4887D8" 
	        width="384" height="288" id="vlc" events="True">
			<param name="Src" value="http://{=script:Y_Live dboxIP=}:31339/0,{=func:get_video_pids {=audiopid=}=}" />
			<param name="ShowDisplay" value="True" />
			<param name="Loop" value="False" />
			<param name="AutoPlay" value="True" />
		The VideoLan Client ActiveX is not installed.<br>
		You need <a href="http://www.videolan.org" target="_blank">VideoLan Client</a> V0.8.2 or higher.<br>
		Install with Option "ActiveX".
	</OBJECT>
</td></tr>
<tr><td>
	<form name="v" action="/Y_Live_Wait.yhtm" method="get">
		<button class="y_live_button" type="button" value="Pause" title="play or pause streaming" id="PlayOrPause" onClick="doPlayOrPause()">Pause</button>
		<button class="y_live_button" type="button" value="stop" title="stop streaming" onClick="doStop()">Stop</button>
		<button class="y_live_button" type="button" value="mute" title="mute / unmute volume" onClick="document.vlc.toggleMute()">Mute</button>
		<button class="y_live_button" type="button" value="fullscreen" title="switch to fullscreen-mode - or use double-click" onClick="document.vlc.fullscreen()">FScreen</button>
		<button class="y_live_button" type="button" value="minus" title="lower volume" onClick="document.vlc.volume=document.vlc.volume-10;">-</button>
		<button class="y_live_button" type="button" value="plus" title="higher volume" onClick="document.vlc.volume = document.vlc.volume+10;">+</button>
		<button class="y_live_button" type="button" value="Lock" title="lock / unlock TV (record mode, rc, lcd)" name="lock" onClick="doLockUnlock()">Lock</button>
		<button class="y_live_button" type="button" value="Streaminfo" title="view streaminfo" name="streaminfo" onClick="view_streaminfo()">sinfo</button>
		<select size="1" class="y_live_audio_pids" name="audiopid" onChange="document.v.submit()">
		{=func:get_audio_pids_as_dropdown=}
		</select>
		<br>
		<input type="hidden" name="browser" value="{=browser=}">
	</form>	
~
	<embed type="application/x-vlc-plugin"
		name="vlc"  id="vlc"
		autoplay="yes" loop="yes" width="384" height="288"
		target="http://{=script:Y_Live dboxIP=}:31339/0,{=func:get_video_pids {=audiopid=}=}" >
	</embed>
</td></tr>
<tr><td>
	<form name="v" action="/Y_Live_Wait.yhtm" method="get">
		<input class="y_live_button" type="button" value="Pause" title="play or pause streaming" name="PlayOrPause" onClick="doPlayOrPause()">
		<button class="y_live_button" type="button" value="stop" title="stop streaming" onClick="doStop()">Stop</button>
		<button class="y_live_button" type="button" value="mute" title="mute / unmute volume" onClick="document.vlc.mute()">Mute</button>
		<button class="y_live_button" type="button" value="fullscreen" title="switch to fullscreen-mode - or use double-click" onClick="document.vlc.fullscreen()">F</button>
		<button class="y_live_button" type="button" value="minus" title="lower volume" onClick="document.vlc.set_volume(document.vlc.get_volume()-10);">-</button>
		<button class="y_live_button" type="button" value="plus" title="higher volume" onClick="document.vlc.set_volume(document.vlc.get_volume()+10);">+</button>
		<input class="y_live_button" type="button" value="Lock" title="lock / unlock TV (record mode, rc, lcd)" name="lock" onClick="doLockUnlock()">
		<button class="y_live_button" type="button" value="Streaminfo" title="view streaminfo" name="streaminfo" onClick="view_streaminfo()">sinfo</button>
		<select size="1" class="y_live_audio_pids" name="audiopid" onChange="document.v.submit()">
		{=func:get_audio_pids_as_dropdown=}
		</select>
		<input type="hidden" name="browser" value="{=browser=}">
	</form>	
=}
</td></tr>
</table>
<script language="JavaScript" type="text/javascript">
	var res_w=parseInt("{=ini-get:/var/tuxbox/config/Y-Web.conf;live_resolution_w;384=}",10);
	var res_h=parseInt("{=ini-get:/var/tuxbox/config/Y-Web.conf;live_resolution_h;288=}",10);
	if(isNaN(res_w)) res_w=384;
	if(isNaN(res_h)) res_h=288;
	
	document.vlc.width=res_w;
	document.vlc.height=res_h;
	for (i = 0; i < document.v.audiopid.length; i++)
		if (document.v.audiopid.options[i].value == "{=if-empty:{=audiopid=}~00000~{=audiopid=}=}")
			document.v.audiopid.options[i].selected = true;

{=if-equal:{=browser=}~moz~
    document.vlc.play()
~=}
</script>	

</body>
</html>